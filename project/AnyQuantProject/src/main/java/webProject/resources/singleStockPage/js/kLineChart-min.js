require.config({paths:{echarts:"../js/echart"}});var element;var $scope;var array;var echarts;var chart3Type="BIAS";var kchartData;var axisData=[];var chart1Data=[];var chart2Data=[];var chart3Data=[];var chart3Data_BIAS6=[];var chart3Data_BIAS12=[];var chart3Data_BIAS24=[];var chart3Data_RSI6=[];var chart3Data_RSI12=[];var chart3Data_RSI24=[];var chart3Data_K=[];var chart3Data_D=[];var chart3Data_J=[];var chart3Data_DEA=[];var chart3Data_DIF=[];var chart3Data_MACD=[];var chart3Data_PMA5=[];var chart3Data_PMA10=[];var chart3Data_PMA30=[];var myChart;var myChart2;var myChart3;var chartLine1;var chartLine2;var chartLine3;var chartLine1_Type;var chartLine2_Type;var chartLine3_Type;var chartLine1_Data;var chartLine2_Data;var chartLine3_Data;function checkBoxChanged(){var c=document.forms[0].chart3Type;for(var a=0;a<=3;a++){if(c[a].checked){chart3Type=c.value}}var b=myChart3.getOption();switch(chart3Type){case"RSI":b.series[0].data=chart3Data_RSI6;b.series[1].data=chart3Data_RSI12;b.series[2].data=chart3Data_RSI24;b.series[0].name="RSI6";b.series[1].name="RSI12";b.series[2].name="RSI24";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["RSI6","RSI12","RSI24"];break;case"BIAS":b.series[0].data=chart3Data_BIAS6;b.series[1].data=chart3Data_BIAS12;b.series[2].data=chart3Data_BIAS24;b.series[0].name="BIAS6";b.series[1].name="BIAS12";b.series[2].name="BIAS24";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["BIAS6","BIAS12","BIAS24"];break;case"MACD":b.series[0].data=chart3Data_MACD;b.series[1].data=chart3Data_DIF;b.series[2].data=chart3Data_DEA;b.series[0].name="MACD";b.series[1].name="DIF";b.series[2].name="DEA";b.series[0].type="bar";b.series[1].type="line";b.series[2].type="line";b.legend.data=["DIF","DEA","MACD"];break;case"KDJ":b.series[0].data=chart3Data_K;b.series[1].data=chart3Data_D;b.series[2].data=chart3Data_J;b.series[0].name="K";b.series[1].name="D";b.series[2].name="J";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["K","D","J"];break}myChart3.setOption(b,true)}var tabFlag;function tabChanged(a){var b=document.forms[0].chart3Type;b[0].checked=true;tabFlag=a;document.forms[0].chart3Type="BIAS";var c;switch(a){case"day":c="日K";kchartData=$scope.dayKLineResult;break;case"week":c="周K";kchartData=$scope.weekKLineResult;break;case"month":c="月K";kchartData=$scope.monthKLineResult;break}paint()}require(["echarts","echarts/chart/k","echarts/chart/bar","echarts/chart/line","echarts/theme/macarons"],function(a){echarts=a;element=angular.element(document.getElementById("main1"));$scope=element.scope();setTimeout(function(){kchartData=$scope.dayKLineResult;paint()},1000)});function paint(){axisData=[];chart1Data=[];chart2Data=[];chart3Data_RSI6=[];chart3Data_RSI12=[];chart3Data_RSI24=[];chart3Data_BIAS6=[];chart3Data_BIAS12=[];chart3Data_BIAS24=[];chart3Data_K=[];chart3Data_D=[];chart3Data_J=[];chart3Data_DEA=[];chart3Data_DIF=[];chart3Data_MACD=[];var c=0;var g=0;for(var e in kchartData){g++}for(var e in kchartData){if(e<g-1){var f=kchartData[e].open;if(f!="0"){axisData[c]=kchartData[e].date;chart1Data[c]=[kchartData[e].open,kchartData[e].close,kchartData[e].low,kchartData[e].high];chart2Data[c]=kchartData[e].volumn;chart3Data_RSI6[c]=kchartData[e].RSI6;chart3Data_RSI12[c]=kchartData[e].RSI12;chart3Data_RSI24[c]=kchartData[e].RSI24;chart3Data_BIAS6[c]=kchartData[e].BIAS6;chart3Data_BIAS12[c]=kchartData[e].BIAS12;chart3Data_BIAS24[c]=kchartData[e].BIAS24;chart3Data_K[c]=kchartData[e].K;chart3Data_D[c]=kchartData[e].D;chart3Data_J[c]=kchartData[e].J;chart3Data_DEA[c]=kchartData[e].DEA;chart3Data_DIF[c]=kchartData[e].DIF;chart3Data_MACD[c]=kchartData[e].MACDBar;chart3Data_PMA5[c]=kchartData[e].PMA5_day;chart3Data_PMA10[c]=kchartData[e].PMA10_day;chart3Data_PMA30[c]=kchartData[e].PMA30_day;c++}}}chartLine1="BIAS6";chartLine2="BIAS12";chartLine3="BIAS24";chartLine1_Type="line";chartLine2_Type="line";chartLine3_Type="line";chartLine1_Data=chart3Data_BIAS6;chartLine2_Data=chart3Data_BIAS12;chartLine3_Data=chart3Data_BIAS24;myChart=echarts.init(document.getElementById("main1"),"macarons");myChart2=echarts.init(document.getElementById("main2"),"macarons");myChart3=echarts.init(document.getElementById("main3"),"macarons");var d={title:{textStyle:{color:"#000000",fontSize:20}},toolbox:{show:true,feature:{magicType:{show:true,type:["line","bar"]},restore:{show:true}},x:"40",y:"top"},tooltip:{trigger:"axis",showDelay:0,formatter:function(i){var h=i[0].name;h+="<br/>"+i[0].seriesName;h+="<br/>  开盘 : "+i[0].value[0]+"  最高 : "+i[0].value[3];h+="<br/>  收盘 : "+i[0].value[1]+"  最低 : "+i[0].value[2];return h}},legend:{data:["K线","5日均线","10日均线","30日均线"],textStyle:{color:"#000000"},x:"center",y:"top"},xAxis:[{type:"category",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,boundaryGap:[0.05,0.05],splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:"5日均线",type:"line",symbol:"none",data:chart3Data_PMA5},{name:"10日均线",type:"line",symbol:"none",data:chart3Data_PMA10},{name:"30日均线",type:"line",symbol:"none",data:chart3Data_PMA30},{name:"K线",type:"k",data:chart1Data,itemStyle:{normal:{label:{show:false}}}}]};var b={tooltip:{trigger:"axis",showDelay:0},legend:{data:["成交量(万)"],x:"center",y:"top"},toolbox:{y:-30,show:true,feature:{mark:{show:true},dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true,realtime:true,start:50,end:100},xAxis:[{type:"category",position:"top",boundaryGap:true,axisLabel:{show:false},axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(h){return Math.round(h/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],color:["#AAB3FF"],series:[{name:"成交量(万)",type:"bar",symbol:"none",data:chart2Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#0072e3",label:{show:false}}},data:[{type:"average",name:"平均值"}]}}]};myChart2.setOption(b,true);var a={tooltip:{trigger:"axis",showDelay:0},legend:{data:[chartLine1,chartLine2,chartLine3],x:"center",y:20},xAxis:[{type:"category",position:"bottom",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(h){return Math.round(h/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:chartLine1,type:chartLine1_Type,symbol:"none",data:chartLine1_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#99CEFF",label:{show:false}}}},{name:chartLine2,type:chartLine1_Type,symbol:"none",data:chartLine2_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#FF60AF",label:{show:true}}}},{name:chartLine3,type:chartLine1_Type,symbol:"none",data:chartLine3_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#0072E3",label:{show:false}}}}]};myChart.connect([myChart2,myChart3]);myChart3.setOption(a,true);myChart.setOption(d,true);myChart2.connect([myChart,myChart3]);myChart3.connect([myChart,myChart2]);setTimeout(function(){window.onresize=function(){myChart.resize();myChart2.resize();myChart3.resize()}},200)};