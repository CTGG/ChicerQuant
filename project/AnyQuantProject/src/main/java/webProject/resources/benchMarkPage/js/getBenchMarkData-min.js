var app=angular.module("benchMarkApp",[]);app.controller("benchMarkCtrl",function(a,e){var d=new Array();var c=[];a.url="http://115.159.97.98/php/serviceController.php";var b="2015-10-01";a.dayKLineResult=[];a.monthKLineResult=[];a.weekKLineResult=[];e.post(a.url,{name:"hs300",date:localStorage.latestDate,method:"getBenchMarkByNameService"}).success(function(f){a.error=false;a.data=f;a.benchMark=f;console.log(a.benchMark);document.getElementById("kName").innerHTML=a.benchMark[0].benchmark_name+" - "+a.benchMark[0].benchmark_id,document.getElementById("elementTitle").innerHTML=a.benchMark[0].benchmark_name;document.getElementById("smallTitle").innerHTML="- "+a.benchMark[0].benchmark_id;document.getElementById("elements").innerHTML="开盘价:"+a.benchMark[0].open+"&nbsp&nbsp&nbsp&nbsp收盘价:"+a.benchMark[0].close+"<br/>最高价:"+a.benchMark[0].high+"&nbsp&nbsp&nbsp&nbsp最低价:"+a.benchMark[0].low+"<br/>后复权价:"+a.benchMark[0].adj_price+"<br/>成交量:"+a.benchMark[0].volumn}).error(function(f){a.error=true;a.data=f;return"error name"});e.post(a.url,{name:"hs300",startdate:b,enddate:localStorage.latestDate,method:"getBenchMarkAmongDateService"}).success(function(m){a.error=false;a.data=m;a.benchMarkInfo=m;var l=0;var f=[];for(var k in a.benchMarkInfo){l++}for(var k in a.benchMarkInfo){if(k<l-1){d[k]=new Array;d[k][0]=a.benchMarkInfo[k].date;d[k][1]=a.benchMarkInfo[k].open;d[k][2]=a.benchMarkInfo[k].high;d[k][3]=a.benchMarkInfo[k].low;d[k][4]=a.benchMarkInfo[k].close;d[k][5]=a.benchMarkInfo[k].volumn;d[k][6]=a.benchMarkInfo[k].adj_price;f[k]=a.benchMarkInfo[k].color}}var h=d;var j=f;var g=0;$(document).ready(function(){$("#table").DataTable({data:h,createdRow:function(i){$("td",i).eq(3).css("color","green");$("td",i).eq(2).css("color","red");$("td",i).eq(1).css("color",j[g]);g++},columns:[{title:"日期"},{title:"开盘价"},{title:"最高价"},{title:"最低价"},{title:"收盘价"},{title:"成交量"},{title:"后复权价"}]})})}).error(function(f){a.error=true;a.data=f;return"error name"});e.post(a.url,{startdate:b,enddate:localStorage.latestDate,name:"hs300",method:"getDayLineService"}).success(function(f){a.data=f;a.dayKLineResult=f}).error(function(f){a.data=f||"Request failed";a.status=status});e.post(a.url,{startdate:b,enddate:localStorage.latestDate,name:"hs300",method:"getWeekLineService"}).success(function(f){a.data=f;a.weekKLineResult=f}).error(function(f){a.data=f||"Request failed";a.status=status});e.post(a.url,{startdate:b,enddate:localStorage.latestDate,name:"hs300",method:"getMonthLineService"}).success(function(f){a.data=f;a.monthKLineResult=f}).error(function(f){a.data=f||"Request failed";a.status=status})});