require.config({paths:{echarts:"../js/echart"}});var element;var $scope;var array;var chart3Type="BIAS";var kchartData;var axisData=[];var chart1Data=[];var chart2Data=[];var chart3Data_BIAS6=[];var chart3Data_BIAS12=[];var chart3Data_BIAS24=[];var chart3Data_RSI6=[];var chart3Data_RSI12=[];var chart3Data_RSI24=[];var chart3Data_K=[];var chart3Data_D=[];var chart3Data_J=[];var chart3Data_DEA=[];var chart3Data_DIF=[];var chart3Data_MACD=[];var myChart;var myChart2;var myChart3;var chartLine1;var chartLine2;var chartLine3;var chartLine1_Type;var chartLine2_Type;var chartLine3_Type;var chartLine1_Data;var chartLine2_Data;var chartLine3_Data;function checkBoxChanged_WEEK(){lineName=document.forms[1].chart3Type_Week;for(i=0;i<=3;i++){if(lineName[i].checked){chart3Type=lineName.value}}console.log(chart3Type);var a=myChart3.getOption();switch(chart3Type){case"RSI":a.series[0].data=chart3Data_RSI6;a.series[1].data=chart3Data_RSI12;a.series[2].data=chart3Data_RSI24;a.series[0].name="RSI6";a.series[1].name="RSI12";a.series[2].name="RSI24";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["RSI6","RSI12","RSI24"];break;case"BIAS":a.series[0].data=chart3Data_BIAS6;a.series[1].data=chart3Data_BIAS12;a.series[2].data=chart3Data_BIAS24;a.series[0].name="BIAS6";a.series[1].name="BIAS12";a.series[2].name="BIAS24";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["BIAS6","BIAS12","BIAS24"];break;case"MACD":a.series[0].data=chart3Data_MACD;a.series[1].data=chart3Data_DIF;a.series[2].data=chart3Data_DEA;a.series[0].name="MACD";a.series[1].name="DIF";a.series[2].name="DEA";a.series[0].type="bar";a.series[1].type="line";a.series[2].type="line";a.legend.data=["DIF","DEA","MACD"];break;case"KDJ":a.series[0].data=chart3Data_K;a.series[1].data=chart3Data_D;a.series[2].data=chart3Data_J;a.series[0].name="K";a.series[1].name="D";a.series[2].name="J";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["K","D","J"];break}myChart3.setOption(a,true)}require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/k","echarts/theme/macarons"],function(a){element=angular.element(document.getElementById("main1"));$scope=element.scope();array=new Array();var b=0;setTimeout(function(){kchartData=$scope.weekKLineResult;for(var k in kchartData){b++}for(var k in kchartData){axisData[k]=kchartData[k].date;chart1Data[k]=[kchartData[k].open,kchartData[k].close,kchartData[k].low,kchartData[k].high];var h=kchartData[k].volumn/100000000;chart2Data[k]=h.toFixed(4);chart3Data_RSI6[k]=kchartData[k].RSI6;chart3Data_RSI12[k]=kchartData[k].RSI12;chart3Data_RSI24[k]=kchartData[k].RSI24;chart3Data_BIAS6[k]=kchartData[k].BIAS6;chart3Data_BIAS12[k]=kchartData[k].BIAS12;chart3Data_BIAS24[k]=kchartData[k].BIAS24;chart3Data_K[k]=kchartData[k].K;chart3Data_D[k]=kchartData[k].D;chart3Data_J[k]=kchartData[k].J;chart3Data_DEA[k]=kchartData[k].DEA;chart3Data_DIF[k]=kchartData[k].DIF;chart3Data_MACD[k]=kchartData[k].MACDBar;if(k<b-1){array[k]=new Array();array[k][0]=kchartData[k].date;array[k][1]=kchartData[k].open*1;array[k][2]=kchartData[k].close*1;array[k][3]=kchartData[k].low*1;array[k][4]=kchartData[k].high*1}}chartLine1="BIAS6";chartLine2="BIAS12";chartLine3="BIAS24";chartLine1_Type="line";chartLine2_Type="line";chartLine3_Type="line";chartLine1_Data=chart3Data_BIAS6;chartLine2_Data=chart3Data_BIAS12;chartLine3_Data=chart3Data_BIAS24;var f=e(array);console.log(f);function e(o){var l=[];var m=[];for(var n=0;n<o.length;n++){l.push(o[n].splice(0,1)[0]);m.push(o[n])}return{categoryData:l,values:m}}function c(q){var m=[];for(var o=0,l=f.values.length;o<l;o++){if(o<q){m.push("-");continue}var p=0;for(var n=0;n<q;n++){p+=f.values[o-n][1]}m.push(p/q)}return m}myChart=a.init(document.getElementById("main1"),"macarons");myChart2=a.init(document.getElementById("main2"),"macarons");myChart3=a.init(document.getElementById("main3"),"macarons");var j={toolbox:{show:true,feature:{dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{left:0,data:["周K","MA5","MA10","MA20","MA30"]},grid:{bottom:"5%"},xAxis:{type:"category",data:f.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false},splitLine:{show:false},splitNumber:20,min:"dataMin",max:"dataMax"},yAxis:{scale:true,splitArea:{show:true}},dataZoom:[{type:"inside",start:50,end:100},{show:true,type:"slider",y:"90%",start:50,end:100}],series:[{name:"周K",type:"k",data:f.values},{name:"MA5",type:"line",data:c(5),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA10",type:"line",data:c(10),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA20",type:"line",data:c(20),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA30",type:"line",data:c(30),smooth:true,lineStyle:{normal:{opacity:0.5}}}]};myChart.setOption(j,true);var g={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:["K线","成交量(亿)","统计指标"]},toolbox:{y:-30,show:true,feature:{mark:{show:true},dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true,realtime:true,height:30,start:50,end:100,top:"5%"},grid:{y:2},xAxis:[{type:"category",position:"top",boundaryGap:true,axisLabel:{show:false},axisTick:{onGap:false},splitLine:{show:false},data:axisData}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(l){return Math.round(l)+" 亿"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:"成交量(亿)",type:"line",symbol:"none",data:chart2Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#484891",label:{show:false}}},data:[{type:"average",name:"平均值"}]}}]};myChart2.setOption(g,true);var d={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:[chartLine1,chartLine2,chartLine3]},xAxis:[{type:"category",position:"bottom",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(l){return Math.round(l/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:chartLine1,type:chartLine1_Type,symbol:"none",data:chartLine1_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#0072E3",label:{show:false}}}},{name:chartLine2,type:chartLine1_Type,symbol:"none",data:chartLine2_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#FF60AF",label:{show:false}}}},{name:chartLine3,type:chartLine1_Type,symbol:"none",data:chartLine3_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#484891",label:{show:false}}}}]};myChart3.setOption(d,true);myChart.connect([myChart2,myChart3]);myChart2.connect([myChart,myChart3]);myChart3.connect([myChart,myChart2]);setTimeout(function(){window.onresize=function(){myChart.resize();myChart2.resize();myChart3.resize()}},200)},1000)});