require.config({paths:{echarts:"../js/echart"}});var element;var $scope;var chart3Type="BIAS";var kchartData;var axisData=[];var chart1Data=[];var chart2Data=[];var chart3Data_BIAS6=[];var chart3Data_BIAS12=[];var chart3Data_BIAS24=[];var chart3Data_RSI6=[];var chart3Data_RSI12=[];var chart3Data_RSI24=[];var chart3Data_K=[];var chart3Data_D=[];var chart3Data_J=[];var chart3Data_DEA=[];var chart3Data_DIF=[];var chart3Data_MACD=[];var myChart;var myChart2;var myChart3;var chartLine1;var chartLine2;var chartLine3;var chartLine1_Type;var chartLine2_Type;var chartLine3_Type;var chartLine1_Data;var chartLine2_Data;var chartLine3_Data;function checkBoxChanged(){var c=document.forms[0].chart3Type;for(var a=0;a<=3;a++){if(c[a].checked){chart3Type=c.value}}var b=myChart3.getOption();switch(chart3Type){case"RSI":b.series[0].data=chart3Data_RSI6;b.series[1].data=chart3Data_RSI12;b.series[2].data=chart3Data_RSI24;b.series[0].name="RSI6";b.series[1].name="RSI12";b.series[2].name="RSI24";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["RSI6","RSI12","RSI24"];break;case"BIAS":b.series[0].data=chart3Data_BIAS6;b.series[1].data=chart3Data_BIAS12;b.series[2].data=chart3Data_BIAS24;b.series[0].name="BIAS6";b.series[1].name="BIAS12";b.series[2].name="BIAS24";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["BIAS6","BIAS12","BIAS24"];break;case"MACD":b.series[0].data=chart3Data_MACD;b.series[1].data=chart3Data_DIF;b.series[2].data=chart3Data_DEA;b.series[0].name="MACD";b.series[1].name="DIF";b.series[2].name="DEA";b.series[0].type="bar";b.series[1].type="line";b.series[2].type="line";b.legend.data=["DIF","DEA","MACD"];break;case"KDJ":b.series[0].data=chart3Data_K;b.series[1].data=chart3Data_D;b.series[2].data=chart3Data_J;b.series[0].name="K";b.series[1].name="D";b.series[2].name="J";b.series[0].type="line";b.series[1].type="line";b.series[2].type="line";b.legend.data=["K","D","J"];break}myChart3.setOption(b,true)}function tabChanged(f){var k=document.forms[0].chart3Type;k[0].checked=true;console.log(f);document.forms[0].chart3Type="BIAS";array=new Array();var g;var b=0;switch(f){case"day":g="日K";kchartData=$scope.dayKLineResult;break;case"week":g="周K";kchartData=$scope.weekKLineResult;console.log(kchartData);break;case"month":g="月K";kchartData=$scope.monthKLineResult;break}axisData=[];chart1Data=[];chart2Data=[];chart3Data_RSI6=[];chart3Data_RSI12=[];chart3Data_RSI24=[];chart3Data_BIAS6=[];chart3Data_BIAS12=[];chart3Data_BIAS24=[];chart3Data_K=[];chart3Data_D=[];chart3Data_J=[];chart3Data_DEA=[];chart3Data_DIF=[];chart3Data_MACD=[];for(var l in kchartData){b++}for(var l in kchartData){axisData[l]=kchartData[l].date;chart1Data[l]=[kchartData[l].open,kchartData[l].close,kchartData[l].low,kchartData[l].high];var j=kchartData[l].volumn/100000000;chart2Data[l]=j.toFixed(4);chart3Data_RSI6[l]=kchartData[l].RSI6;chart3Data_RSI12[l]=kchartData[l].RSI12;chart3Data_RSI24[l]=kchartData[l].RSI24;chart3Data_BIAS6[l]=kchartData[l].BIAS6;chart3Data_BIAS12[l]=kchartData[l].BIAS12;chart3Data_BIAS24[l]=kchartData[l].BIAS24;chart3Data_K[l]=kchartData[l].K;chart3Data_D[l]=kchartData[l].D;chart3Data_J[l]=kchartData[l].J;chart3Data_DEA[l]=kchartData[l].DEA;chart3Data_DIF[l]=kchartData[l].DIF;chart3Data_MACD[l]=kchartData[l].MACDBar;chart3Data_PMA5=kchartData[l].PMA5_day;chart3Data_PMA10=kchartData[l].PMA10_day;chart3Data_PMA30=kchartData[l].PMA30_day;if(l<b-1){array[l]=new Array();array[l][0]=kchartData[l].date;array[l][1]=kchartData[l].open*1;array[l][2]=kchartData[l].close*1;array[l][3]=kchartData[l].low*1;array[l][4]=kchartData[l].high*1}}chartLine1="BIAS6";chartLine2="BIAS12";chartLine3="BIAS24";chartLine1_Type="line";chartLine2_Type="line";chartLine3_Type="line";chartLine1_Data=chart3Data_BIAS6;chartLine2_Data=chart3Data_BIAS12;chartLine3_Data=chart3Data_BIAS24;var d=c(array);function c(p){var m=[];var n=[];for(var o=0;o<p.length;o++){m.push(p[o].splice(0,1)[0]);n.push(p[o])}return{categoryData:m,values:n}}function a(r){var n=[];for(var p=0,m=d.values.length;p<m;p++){if(p<r){n.push("-");continue}var q=0;for(var o=0;o<r;o++){q+=d.values[p-o][1]}n.push(q/r)}return n}var e={toolbox:{show:true,feature:{dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{left:0,data:["K线","MA5","MA10","MA20","MA30"]},grid:{bottom:"5%"},xAxis:{type:"category",data:d.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false},splitLine:{show:false},splitNumber:20,min:"dataMin",max:"dataMax"},yAxis:{scale:true,splitArea:{show:true}},dataZoom:[{type:"inside",start:50,end:100},{show:true,type:"slider",y:"90%",start:50,end:100}],series:[{name:"K线",type:"k",data:d.values},{name:"MA5",type:"line",data:a(5),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA10",type:"line",data:a(10),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA20",type:"line",data:a(20),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA30",type:"line",data:a(30),smooth:true,lineStyle:{normal:{opacity:0.5}}}]};var i={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:["K线","成交量(亿)","统计指标"]},toolbox:{y:-30,show:true,feature:{mark:{show:true},dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true,realtime:true,height:30,start:50,end:100,top:"5%"},grid:{y:2},xAxis:[{type:"category",position:"top",boundaryGap:true,axisLabel:{show:false},axisTick:{onGap:false},splitLine:{show:false},data:axisData}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(m){return Math.round(m)+" 亿"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:"成交量(亿)",type:"line",symbol:"none",data:chart2Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#484891",label:{show:false}}},data:[{type:"average",name:"平均值"}]}}]};myChart2.setOption(i,true);var h={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:[chartLine1,chartLine2,chartLine3]},xAxis:[{type:"category",position:"bottom",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(m){return Math.round(m/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:chartLine1,type:chartLine1_Type,symbol:"none",data:chartLine1_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#0072E3",label:{show:false}}}},{name:chartLine2,type:chartLine1_Type,symbol:"none",data:chartLine2_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#FF60AF",label:{show:false}}}},{name:chartLine3,type:chartLine1_Type,symbol:"none",data:chartLine3_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#484891",label:{show:false}}}}]};myChart.connect([myChart2,myChart3]);myChart3.setOption(h,true);myChart.setOption(e,true);myChart2.connect([myChart,myChart3]);myChart3.connect([myChart,myChart2]);setTimeout(function(){window.onresize=function(){myChart.resize();myChart2.resize();myChart3.resize()}},200)}require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/k","echarts/theme/macarons"],function(a){element=angular.element(document.getElementById("main1"));$scope=element.scope();array=new Array();var b=0;setTimeout(function(){kchartData=$scope.dayKLineResult;for(var j in kchartData){b++}for(var j in kchartData){axisData[j]=kchartData[j].date;chart1Data[j]=[kchartData[j].open,kchartData[j].close,kchartData[j].low,kchartData[j].high];var h=kchartData[j].volumn/100000000;chart2Data[j]=h.toFixed(4);chart3Data_RSI6[j]=kchartData[j].RSI6;chart3Data_RSI12[j]=kchartData[j].RSI12;chart3Data_RSI24[j]=kchartData[j].RSI24;chart3Data_BIAS6[j]=kchartData[j].BIAS6;chart3Data_BIAS12[j]=kchartData[j].BIAS12;chart3Data_BIAS24[j]=kchartData[j].BIAS24;chart3Data_K[j]=kchartData[j].K;chart3Data_D[j]=kchartData[j].D;chart3Data_J[j]=kchartData[j].J;chart3Data_DEA[j]=kchartData[j].DEA;chart3Data_DIF[j]=kchartData[j].DIF;chart3Data_MACD[j]=kchartData[j].MACDBar;chart3Data_PMA5=kchartData[j].PMA5_day;chart3Data_PMA10=kchartData[j].PMA10_day;chart3Data_PMA30=kchartData[j].PMA30_day;if(j<b-1){array[j]=new Array();array[j][0]=kchartData[j].date;array[j][1]=kchartData[j].open*1;array[j][2]=kchartData[j].close*1;array[j][3]=kchartData[j].low*1;array[j][4]=kchartData[j].high*1}}chartLine1="BIAS6";chartLine2="BIAS12";chartLine3="BIAS24";chartLine1_Type="line";chartLine2_Type="line";chartLine3_Type="line";chartLine1_Data=chart3Data_BIAS6;chartLine2_Data=chart3Data_BIAS12;chartLine3_Data=chart3Data_BIAS24;var f=e(array);console.log(f);function e(n){var k=[];var l=[];for(var m=0;m<n.length;m++){k.push(n[m].splice(0,1)[0]);l.push(n[m])}return{categoryData:k,values:l}}function c(p){var l=[];for(var n=0,k=f.values.length;n<k;n++){if(n<p){l.push("-");continue}var o=0;for(var m=0;m<p;m++){o+=f.values[n-m][1]}l.push(o/p)}return l}myChart=a.init(document.getElementById("main1"),"macarons");myChart2=a.init(document.getElementById("main2"),"macarons");myChart3=a.init(document.getElementById("main3"),"macarons");var i={toolbox:{show:true,feature:{dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{left:0,data:["K线","MA5","MA10","MA20","MA30"]},grid:{bottom:"5%"},xAxis:{type:"category",data:f.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false},splitLine:{show:false},splitNumber:20,min:"dataMin",max:"dataMax"},yAxis:{scale:true,splitArea:{show:true}},dataZoom:[{type:"inside",start:50,end:100},{show:true,type:"slider",y:"90%",start:50,end:100}],series:[{name:"K线",type:"k",data:f.values},{name:"MA5",type:"line",data:c(5),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA10",type:"line",data:c(10),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA20",type:"line",data:c(20),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA30",type:"line",data:c(30),smooth:true,lineStyle:{normal:{opacity:0.5}}}]};var g={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:["K线","成交量(亿)","统计指标"]},toolbox:{y:-30,show:true,feature:{mark:{show:true},dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true,realtime:true,height:30,start:50,end:100,top:"5%"},grid:{y:2},xAxis:[{type:"category",position:"top",boundaryGap:true,axisLabel:{show:false},axisTick:{onGap:false},splitLine:{show:false},data:axisData}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(k){return Math.round(k)+" 亿"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:"成交量(亿)",type:"line",symbol:"none",data:chart2Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#484891",label:{show:false}}},data:[{type:"average",name:"平均值"}]}}]};myChart2.setOption(g,true);var d={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:[chartLine1,chartLine2,chartLine3]},xAxis:[{type:"category",position:"bottom",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(k){return Math.round(k/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:chartLine1,type:chartLine1_Type,symbol:"none",data:chartLine1_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#0072E3",label:{show:false}}}},{name:chartLine2,type:chartLine1_Type,symbol:"none",data:chartLine2_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#FF60AF",label:{show:false}}}},{name:chartLine3,type:chartLine1_Type,symbol:"none",data:chartLine3_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#484891",label:{show:false}}}}]};myChart.connect([myChart2,myChart3]);myChart3.setOption(d,true);myChart.setOption(i,true);myChart2.connect([myChart,myChart3]);myChart3.connect([myChart,myChart2]);setTimeout(function(){window.onresize=function(){myChart.resize();myChart2.resize();myChart3.resize()}},200)},1000)});