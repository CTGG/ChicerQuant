require.config({paths:{echarts:"../js/echart"}});var element;var $scope;var array;var chart3Type="BIAS";var kchartData;var axisData=[];var chart1Data=[];var chart2Data=[];var chart3Data_BIAS6=[];var chart3Data_BIAS12=[];var chart3Data_BIAS24=[];var chart3Data_RSI6=[];var chart3Data_RSI12=[];var chart3Data_RSI24=[];var chart3Data_K=[];var chart3Data_D=[];var chart3Data_J=[];var chart3Data_DEA=[];var chart3Data_DIF=[];var chart3Data_MACD=[];var myChart;var myChart2;var myChart3;var chartLine1;var chartLine2;var chartLine3;var chartLine1_Type;var chartLine2_Type;var chartLine3_Type;var chartLine1_Data;var chartLine2_Data;var chartLine3_Data;function checkBoxChanged_MONTH(){lineName=document.forms[0].chart3Type;for(i=0;i<=3;i++){if(lineName[i].checked){chart3Type=lineName.value}}var a=myChart3.getOption();switch(chart3Type){case"RSI":a.series[0].data=chart3Data_RSI6;a.series[1].data=chart3Data_RSI12;a.series[2].data=chart3Data_RSI24;a.series[0].name="RSI6";a.series[1].name="RSI12";a.series[2].name="RSI24";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["RSI6","RSI12","RSI24"];break;case"BIAS":a.series[0].data=chart3Data_BIAS6;a.series[1].data=chart3Data_BIAS12;a.series[2].data=chart3Data_BIAS24;a.series[0].name="BIAS6";a.series[1].name="BIAS12";a.series[2].name="BIAS24";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["BIAS6","BIAS12","BIAS24"];break;case"MACD":a.series[0].data=chart3Data_MACD;a.series[1].data=chart3Data_DIF;a.series[2].data=chart3Data_DEA;a.series[0].name="MACD";a.series[1].name="DIF";a.series[2].name="DEA";a.series[0].type="bar";a.series[1].type="line";a.series[2].type="line";a.legend.data=["DIF","DEA","MACD"];break;case"KDJ":a.series[0].data=chart3Data_K;a.series[1].data=chart3Data_D;a.series[2].data=chart3Data_J;a.series[0].name="K";a.series[1].name="D";a.series[2].name="J";a.series[0].type="line";a.series[1].type="line";a.series[2].type="line";a.legend.data=["K","D","J"];break}myChart3.setOption(a,true)}require(["echarts","echarts/chart/bar","echarts/chart/line","echarts/chart/k","echarts/theme/macarons"],function(a){element=angular.element(document.getElementById("main1"));$scope=element.scope();array=new Array();var b=0;setTimeout(function(){kchartData=$scope.monthKLineResult;for(var n in kchartData){b++}for(var n in kchartData){axisData[n]=kchartData[n].date;chart1Data[n]=[kchartData[n].open,kchartData[n].close,kchartData[n].low,kchartData[n].high];var m=kchartData[n].volumn/100000000;chart2Data[n]=m.toFixed(4);chart3Data_RSI6[n]=kchartData[n].RSI6;chart3Data_RSI12[n]=kchartData[n].RSI12;chart3Data_RSI24[n]=kchartData[n].RSI24;chart3Data_BIAS6[n]=kchartData[n].BIAS6;chart3Data_BIAS12[n]=kchartData[n].BIAS12;chart3Data_BIAS24[n]=kchartData[n].BIAS24;chart3Data_K[n]=kchartData[n].K;chart3Data_D[n]=kchartData[n].D;chart3Data_J[n]=kchartData[n].J;chart3Data_DEA[n]=kchartData[n].DEA;chart3Data_DIF[n]=kchartData[n].DIF;chart3Data_MACD[n]=kchartData[n].MACDBar;chart3Data_PMA5=kchartData[n].PMA5_day;chart3Data_PMA10=kchartData[n].PMA10_day;chart3Data_PMA30=kchartData[n].PMA30_day;if(n<b-1){array[n]=new Array();array[n][0]=kchartData[n].date;array[n][1]=kchartData[n].open*1;array[n][2]=kchartData[n].close*1;array[n][3]=kchartData[n].low*1;array[n][4]=kchartData[n].high*1}}chartLine1="BIAS6";chartLine2="BIAS12";chartLine3="BIAS24";chartLine1_Type="line";chartLine2_Type="line";chartLine3_Type="line";chartLine1_Data=chart3Data_BIAS6;chartLine2_Data=chart3Data_BIAS12;chartLine3_Data=chart3Data_BIAS24;var e=d(array);console.log(e);function d(r){var o=[];var p=[];for(var q=0;q<r.length;q++){o.push(r[q].splice(0,1)[0]);p.push(r[q])}return{categoryData:o,values:p}}function c(t){var p=[];for(var r=0,o=e.values.length;r<o;r++){if(r<t){p.push("-");continue}var s=0;for(var q=0;q<t;q++){s+=e.values[r-q][1]}p.push(s/t)}return p}var j=a.init(document.getElementById("main1"),"macarons");var h=a.init(document.getElementById("main2"),"macarons");var g=a.init(document.getElementById("main3"),"macarons");var f={toolbox:{show:true,feature:{dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},tooltip:{trigger:"axis",axisPointer:{type:"line"}},legend:{left:0,data:["月K","MA5","MA10","MA20","MA30"]},grid:{bottom:"5%"},xAxis:{type:"category",data:e.categoryData,scale:true,boundaryGap:false,axisLine:{onZero:false},splitLine:{show:false},splitNumber:20,min:"dataMin",max:"dataMax"},yAxis:{scale:true,splitArea:{show:true}},dataZoom:[{type:"inside",start:50,end:100},{show:true,type:"slider",y:"90%",start:50,end:100}],series:[{name:"月K",type:"k",data:e.values},{name:"MA5",type:"line",data:c(5),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA10",type:"line",data:c(10),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA20",type:"line",data:c(20),smooth:true,lineStyle:{normal:{opacity:0.5}}},{name:"MA30",type:"line",data:c(30),smooth:true,lineStyle:{normal:{opacity:0.5}}}]};j.setOption(f,true);var l={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:["K线","成交量(亿)","统计指标"]},toolbox:{y:-30,show:true,feature:{mark:{show:true},dataZoom:{show:true},dataView:{show:true,readOnly:false},magicType:{show:true,type:["line","bar"]},restore:{show:true},saveAsImage:{show:true}}},dataZoom:{show:true,realtime:true,height:30,start:50,end:100,top:"5%"},grid:{y:2},xAxis:[{type:"category",position:"top",boundaryGap:true,axisLabel:{show:false},axisTick:{onGap:false},splitLine:{show:false},data:axisData}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(o){return Math.round(o)+" 亿"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:"成交量(亿)",type:"line",symbol:"none",data:chart2Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#484891",label:{show:false}}},data:[{type:"average",name:"平均值"}]}}]};h.setOption(l,true);var k={tooltip:{trigger:"axis",showDelay:0},legend:{y:-30,data:[chartLine1,chartLine2,chartLine3]},xAxis:[{type:"category",position:"bottom",boundaryGap:true,axisTick:{onGap:false},splitLine:{show:false},data:axisData,axisLabel:{show:true,textStyle:{color:"#000000"}}}],yAxis:[{type:"value",scale:true,splitNumber:3,boundaryGap:[0.05,0.05],axisLabel:{formatter:function(o){return Math.round(o/10000)+" 万"}},splitArea:{show:true},axisLabel:{show:true,textStyle:{color:"#000000"}}}],series:[{name:chartLine1,type:chartLine1_Type,symbol:"none",data:chartLine1_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#0072E3",label:{show:true}}}},{name:chartLine2,type:chartLine1_Type,symbol:"none",data:chartLine2_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#FF60AF",label:{show:true}}}},{name:chartLine3,type:chartLine1_Type,symbol:"none",data:chartLine3_Data,markLine:{symbol:"none",itemStyle:{normal:{color:"#000000",label:{show:false}}},data:[{type:"average",name:"平均值"}]},itemStyle:{normal:{color:"#484891",label:{show:false}}}}]};g.setOption(k,true);j.connect([h,g]);h.connect([j,g]);g.connect([j,h]);setTimeout(function(){window.onresize=function(){j.resize();h.resize();g.resize()}},200)},1000)});